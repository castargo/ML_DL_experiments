# Пара слов о ML-проектах

### Структура ML-проекта
* [Cookiecutter Data Science](https://drivendata.github.io/cookiecutter-data-science/) 

```
├── project/
    ├── .dvc/
    ├── configs/
    ├── data/
    ├── notebooks/
    ├── models/
    ├── src/
    ├── Makefile
    dvc.yaml
    params.yaml
    README.md
    requirements.txt
    setup.sh
```

### ML-модель в бизнесе

1. Обзор задачи
    * Определение задачи
    * Согласование бизнес-требований
    * Согласование бизнес-метрики
2. Исследование данных
    * Исследование разметки данных, проверка на наличие ошибок
    * EDA: распределение данных, периодичность, сэмплирование, вызревание, шум
    * Доступность источника данных  в будущем
    * События, которые могут повлиять на данные
    * Разделение данных на train/oos/oot
    * Удалены ли ликующие признаки?
    * Удалось ли избежать систематической ошибки отбора?
3. Разработка
    * Предобработка данных
        * Для всех наборов должна быть одинакова
        * Поиск аномалий в данных
        * Изучение и заполнение пропусков
    * Feature engineering
        * Нормирование фичей
        * Кодирование фичей (квантили, таргет-энкодинг)
        * Генерация признаков
        * Подготовка имеющихся признаков
    * Feature selection
        * Удаляем шумные признаки - PSI
        * Удаляем слабые признаки - Feature importances
        * Удаляем скоррелированные фичи (для некоторых типов моделей)
    * Выбор, обучение и тюнинг ML-модели
        * Особенности выбранной модели
        * Подбор гиперпараметров
        * Кросс-валидация
        * Optuna
    * Комбинация нескольких моделей:
        * Блендинг
        * Стекинг (фичи, несколько уровней и тд)
        * Гибрид: извлекаем эмбендинги при помощи нейронок и закидываем их в бустинги
4. Валидация модели
    * Анализ ошибок нескольких версий модели, их метрик качества, кривых обучения
    * Решение является стабильным (нет переобучения)? Что будет, если изменить seed? Если есть временная зависимость в данных, решение устойчиво работает по месяцам?
    * Решение быстро работает?
    * Подобрана правильная метрика оценки модели (loss-функция)? Метрика сочетается с бизнес-метрикой?
5. Использование модели в бизнес-процессе
    * Микросервис + база данных
6. Мониторинг модели
